#
#    DeltaFi - Data transformation and enrichment platform
#
#    Copyright 2022 DeltaFi Contributors <deltafi@deltafi.org>
#
#    Licensed under the Apache License, Version 2.0 (the "License");
#    you may not use this file except in compliance with the License.
#    You may obtain a copy of the License at
#
#        http://www.apache.org/licenses/LICENSE-2.0
#
#    Unless required by applicable law or agreed to in writing, software
#    distributed under the License is distributed on an "AS IS" BASIS,
#    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#    See the License for the specific language governing permissions and
#    limitations under the License.
#

mutation {
    actionEvent(
        event: {
            did: "%1$s"
            action: "sampleIngress.SampleLoadAction"
            start: "2021-07-11T13:44:22.183Z"
            stop: "2021-07-11T13:44:22.184Z"
            type: SPLIT
            split: [
                {
                    sourceInfo: {
                        filename: "file1"
                        flow: "childFlow"
                        metadata: []
                    }
                    content: [
                        {
                            contentReference: {
                                segments: [{
                                    uuid: "objectName"
                                    offset: 0
                                    size: 250
                                    did: "%1$s" }]
                                mediaType: "application/octet-stream"
                            }
                        }
                        {
                            contentReference: {
                                segments: [{
                                    uuid: "objectName2"
                                    offset: 0
                                    size: 400
                                    did: "%1$s" }]
                                mediaType: "application/xml"
                            }
                        }
                    ]
                },
                {
                    sourceInfo: {
                        filename: "file2"
                        flow: "childFlow"
                        metadata: []
                    }
                    content: [
                        {
                            contentReference: {
                                segments: [{
                                    uuid: "objectName"
                                    offset: 250
                                    size: 250
                                    did: "%1$s" }]
                                mediaType: "application/octet-stream"
                            }
                        }
                    ]
                }
            ]
        }
    ) {
        did
        stage
        actions {
            name
            state
            errorCause
            errorContext
        }
    }
}
