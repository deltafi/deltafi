plugins {
  id 'org.ajoberstar.reckon' version '0.13.0'
  id 'test-summary' // Local plugin
}

ext {
    javaSourceCompatibility = JavaVersion.VERSION_11
    javaTargetCompatibility = JavaVersion.VERSION_11
}

reckon {
    scopeFromProp()
    snapshotFromProp()
}

allprojects { project ->
    task version {
        doLast {
            println "Version is reckoned to " + "$version"
        }
    }
}

subprojects {
    group 'org.deltafi'

    apply plugin: 'java'

    repositories {
        mavenLocal()
        mavenCentral()
        maven {
            url groupMavenRepo
            name "GitLab"
            if(project.hasProperty('gitLabTokenType') && project.hasProperty('gitLabToken')) {
                credentials(HttpHeaderCredentials) {
                    name = gitLabTokenType
                    value = gitLabToken
                }
            }
            authentication {
                header(HttpHeaderAuthentication)
            }
        }
    }

    dependencies {
        compileOnly "org.projectlombok:lombok:${lombokVersion}"
        annotationProcessor "org.projectlombok:lombok:${lombokVersion}"
        testCompileOnly "org.projectlombok:lombok:${lombokVersion}"
        testAnnotationProcessor "org.projectlombok:lombok:${lombokVersion}"
    }
}

repositories {
    mavenLocal()
    mavenCentral()
    maven {
        url groupMavenRepo
        name "GitLab"
        credentials(HttpHeaderCredentials) {
            name = gitLabTokenType
            value = gitLabToken
        }
        authentication {
            header(HttpHeaderAuthentication)
        }
    }
}
